{"version":3,"file":"test.js","sourceRoot":"","sources":["../src/test.ts"],"names":[],"mappings":"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","sourcesContent":["import { randomBytes, timingSafeEqual } from 'crypto'\nimport { encode, decode } from './b32'\n\nfunction padStart(s:string, n:number = 0, c:string = ' '):string {\n\t// if ('padStart' in s) return s.padStart(n, c)\n\twhile (s.length < n)\n\t\ts = c + s\n\treturn s\n}\nfunction test(buf:Uint8Array | Buffer | string) {\n\tconst s = 'string' === typeof buf\n\t\t? buf\n\t\t: String.fromCodePoint(...buf)\n\tconsole.log(\n\t\t'%s %j',\n\t\tpadStart(s.length.toString(), 5),\n\t\ts.toString()\n\t)\n}\nconst init = process.hrtime()\nfunction rt(diff:number[] = process.hrtime(init)) {\n\tconst tm = (diff[0] + diff[1] / 1_000_000_000)\n\tconsole.log(\n\t\t'%sms elapsed',\n\t\tpadStart(tm.toFixed(9), 12)\n\t)\n}\nconst okey:Uint8Array[] = []\nfor (let i = 0; i < 35; i++) {\n\tconst buf = new Uint8Array(i + 1)\n\tfor (let j = 0; j < buf.length; j++)\n\t\tbuf[j] = j & 1 ? 0x41 : 0x61\n\tokey.push(buf)\n}\nconst okay = okey.map(buf => encode(buf))\nconst otey = okay.map(buf => decode(buf))\nfor (let i = 0; i < okey.length; i++)\n\tfor (const bin of [okey[i], okay[i], otey[i]])\n\t\ttest(bin)\n\nconst buf = Buffer.from('This is a test buffer.')\nrt()\ntest(buf)\n\nconst b32 = encode(buf)\nrt()\ntest(b32)\n\nconst b32Decoded = decode(b32),\n\tback = Buffer.from(b32Decoded.buffer as ArrayBuffer, b32Decoded.byteOffset, b32Decoded.byteLength)\nrt()\ntest(back)\n\nconsole.assert(timingSafeEqual(buf, back), 'buf !== back')\n\nrt()\ntest(Buffer.from('Starting random bytes (shown as hex)'))\nconst rndbuf = randomBytes(16)\nrt()\ntest(rndbuf.toString('hex'))\n\nconst rndb32 = encode(rndbuf)\nrt()\ntest(rndb32)\n\nconst rndb32Decoded = decode(rndb32),\n\trndback = Buffer.from(rndb32Decoded.buffer as ArrayBuffer, rndb32Decoded.byteOffset, rndb32Decoded.byteLength)\n\nrt()\ntest(rndback.toString('hex'))\n\nconsole.assert(timingSafeEqual(rndbuf, rndback), 'rndbuf !== rndback')\n\n"]}