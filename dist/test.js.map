{"version":3,"file":"test.js","sourceRoot":"","sources":["../src/test.ts"],"names":[],"mappings":"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","sourcesContent":["import { randomBytes, timingSafeEqual, createHash } from 'crypto'\nimport { encode, decode } from './b32'\n\nfunction test(buf: Uint8Array | Buffer | string) {\n\tconst s = 'string' === typeof buf\n\t\t? buf\n\t\t: String.fromCodePoint(...buf)\n\tconsole.log('%s %j', s.length.toString().padStart(5), s)\n}\nconst init = process.hrtime()\nfunction rt(diff: number[] = process.hrtime(init)) {\n\tconst tm = (diff[0] + diff[1] / 1_000_000_000)\n\tconsole.log('%sms elapsed', tm.toFixed(9).padStart(12))\n}\nconst okey: Uint8Array[] = []\nfor (let i = 0; i < 35; i++) {\n\tlet j = i + 1\n\tconst buf = new Uint8Array(j)\n\twhile (j--) buf[j] = 0x41 | (j & 1) << 5\n\tokey.push(buf)\n}\nconst okay = okey.map(buf => encode(buf))\nconst otey = okay.map(buf => decode(buf))\nfor (let i = 0; i < okey.length; i++)\n\tfor (const bin of [okey[i], okay[i], otey[i]])\n\t\ttest(bin)\n\nconst buf = Buffer.from('This is a test buffer.')\nrt()\ntest(buf)\n\nconst b32 = encode(buf)\nrt()\ntest(b32)\n\nconst b32Decoded = decode(b32),\n\tback = Buffer.from(b32Decoded.buffer as ArrayBuffer, b32Decoded.byteOffset, b32Decoded.byteLength)\nrt()\ntest(back)\n\nconsole.assert(timingSafeEqual(buf, back), 'buf !== back')\n\nrt()\ntest(Buffer.from('Starting random bytes (shown as hex)'))\nconst rndbuf = randomBytes(16)\nrt()\ntest(rndbuf.toString('hex'))\n\nconst rndb32 = encode(rndbuf)\nrt()\ntest(rndb32)\n\nconst rndb32Decoded = decode(rndb32),\n\trndback = Buffer.from(rndb32Decoded.buffer as ArrayBuffer, rndb32Decoded.byteOffset, rndb32Decoded.byteLength)\n\nrt()\ntest(rndback.toString('hex'))\n\nconsole.assert(timingSafeEqual(rndbuf, rndback), 'rndbuf !== rndback')\n\nrt()\ntest(Buffer.from('Testing 20-byte hash sum'))\nconst hash = createHash('sha1').update('Hello world!').digest()\nrt()\ntest(hash.toString('hex'))\n\nconst hashb32 = encode(hash, true)\nrt()\ntest(hashb32)\n\nconst hash32d = decode(hashb32),\n\thashback = Buffer.from(hash32d.buffer as ArrayBuffer, hash32d.byteOffset, hash32d.byteLength)\nrt()\ntest(hashback.toString('hex'))\n"]}